---
title: "Indicadores de conectividad en los municipios del estado de Veracruz"
author: "Edson John Sanchez G."
date: "6/10/2022"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Indicadores de conectividad e los municipios de Veracruz.

#### Este archivo contiene cdigo para generar indicadores de conectividad de los diferentes municipios de veracruz. Por ejemplo:
* Porcentaje total de hogares con internet.
* Porcentaje total de hogares con acceso a un celular.
* Porcentaje total de hogares con acceso a television.
* Porcentaje total de hogares con acceso a PC.
* Porcentaje total de hogares sin acceso a internet. 
* Porcentaje total de hogares sin acceso a una PC.
* Porcentaje total de hogares sin acceso a las tecnlogias de la comunicacion. 


#### La base de datos se tom贸 del CENSO 2020, secci贸n Datos Abiertos.

#### Se descargan 煤nicamente los datos del estado de Veracruz del siguiente link general:

* https://www.inegi.org.mx/programas/ccpv/2020/#Datos_abiertos

#### Link directo a la url de los Principales Resultados por Localidad (ITER)

* https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_30_cpv2020_csv.zip

#### Limpiamos nuestro entorno
```{r}
# rm(list = ls())
```

#### URL de datos de Veracruz
```{r}
url <- "https://www.inegi.org.mx/contenidos/programas/ccpv/2020/datosabiertos/iter/iter_30_cpv2020_csv.zip"
```

#### Establecer directorio de trabajo y crear carpeta de extracci贸n. Es importante aclarar que el Knit no se puede usar el setwd(), por lo tanto, hay que codificar el el cambio de directorio de trabajo desde el setup de knit.  


```{r, include=FALSE, echo=FALSE}
#require("knitr")
#opts_knit$set(root.dir = "/Users/edsonsanchezgonzalez/Desktop/conectividad_veracruz/Datos")
#raiz=setwd("/Users/edsonsanchezgonzalez/Desktop/conectividad_veracruz")
#dir.create("Datos",showWarnings = F)
#directorio=paste0(raiz,"/Datos")
#setwd(directorio)

```

#### #Se establece que, si no existe el archivo de datos de Veracruz, se descargue el zip de la URL de INEGI

```{r}
if (!file.exists("conjunto_de_datos_iter_30CSV20.csv")) {
  download.file(url,destfile = "Datos.zip",quiet = FALSE, mode="wb")}
```


#### Se busca extraer la base de Zip. 
```{r, include=FALSE, echo=FALSE}
#require("knitr")
#opts_knit$set(root.dir = "/Users/edsonsanchezgonzalez/Desktop/conectividad_veracruz/iter_30_cpv2020/conjunto_de_datos/")

unzip("Datos.zip")

```

### Fijo nuevo directorio de trabajo. Es importante aclarar que el Knit no se puede usar el setwd(), por lo tanto, hay que codificar el el cambio de directorio de trabajo desde el setup de knit.  

```{r, include=FALSE, echo=FALSE}
#require("knitr")
#opts_knit$set(root.dir = "/Users/edsonsanchezgonzalez/Desktop/conectividad_veracruz/iter_30_cpv2020/conjunto_de_datos/")


#directorio=paste0(raiz,"iter_30_cpv2020/conjunto_de_datos/")
#setwd(directorio)
```


### Importamos las librerias que utilizaremos, en este caso tidyverse y dplyr.

```{r}
library(readxl)
library(tidyverse)
library(ggplot2)
library(dplyr)
```

### Se importa la base de datos del estado de Veracruz

```{r}
Veracruz <- read.csv("iter_30_cpv2020/conjunto_de_datos/conjunto_de_datos_iter_30CSV20.csv")
#View(Veracruz)
head(Veracruz)
```

### Paso 1: Se eligen solo las variables que se utilizar谩n para construir los indicadores de conectividad antes descritos.
### Paso 2: Con la funci贸n filter () se filtran s贸lo las filas que contienen la informaci贸n agregada de cada municipio de Veracruz.
### Paso 3: Con la funci贸n mutate() se crean nuevas columnas que correspoden a los indicadores de conectividad que nos interesa construir. 
### Paso 4: Con la funci贸n mutate () se crea la variable "categor铆a_internet"" para determinar si por el indicador de porcentaje total de hogares con internet de cada municipio, pertenece a una categor铆a de acceso de internet "Muy Bajo", "Bajo", "Medio" o "Alto"


```{r}
Base_2<- select(Veracruz,"ENTIDAD", "NOM_ENT", "MUN", "NOM_MUN","LOC","NOM_LOC","VPH_RADIO",
                "VPH_TV",  "VPH_PC", "VPH_TELEF", "VPH_CEL",
                "VPH_INTER", "TOTHOG", "VPH_SINTIC","VPH_SINCINT","VIVTOT") %>%  
  filter(NOM_LOC=="Total del Municipio") %>% 
  mutate(Porcentaje_Internet=as.numeric(VPH_INTER)/as.numeric(VIVTOT)*100) %>% 
  mutate(Porcentaje_Celular=as.numeric(VPH_CEL)/as.numeric(VIVTOT)*100) %>% 
  mutate(Porcentaje_TV=as.numeric(VPH_TV)/as.numeric(VIVTOT)*100) %>% 
  mutate(Porcentaje_PC=as.numeric(VPH_PC)/as.numeric(VIVTOT)*100) %>% 
  mutate(Porcentaje_SinInternet_PC=as.numeric(VPH_SINCINT)/as.numeric(VIVTOT)*100) %>% 
  mutate(Porcentaje_SinTic=as.numeric(VPH_SINTIC)/as.numeric(VIVTOT)*100) %>% 
  mutate(Categoria_internet=cut(Porcentaje_Internet,breaks = c(0,11.85,18.98,27.46,Inf), 
  labels = c("Muy bajo", "Bajo", "Medio", "Alto")))

head(Base_2)
```




